# Игровой Маркетплейс с Telegram интеграцией

Этот проект представляет собой игровой маркетплейс с авторизацией через Telegram и интеграцией с базой данных SQLite.

## Структура проекта

### Веб-приложение
- React + TypeScript + Vite
- Tailwind CSS для стилизации
- Интеграция с Telegram Login Widget
- API для взаимодействия с базой данных

### Telegram бот
- Python + telebot
- Интеграция с SQLite базой данных
- Веб-приложение внутри бота для покупки подписок

### База данных
- SQLite
- Таблицы для пользователей и подписок

## Установка и запуск

### Веб-приложение
```bash
# Установка зависимостей
npm install

# Запуск в режиме разработки
npm run dev

# Сборка для продакшена
npm run build
```

### Telegram бот
```bash
# Установка зависимостей
pip install pyTelegramBotAPI flask

# Запуск бота
python bot.py

# Запуск веб-сервера для API
python web_integration.py
```

## Структура базы данных

### Таблица users
- user_id: ID пользователя в Telegram (первичный ключ)
- website_reg_date: Дата регистрации на сайте
- bot_reg_date: Дата регистрации в боте
- has_subscription: Флаг наличия подписки (0/1)

### Таблица subscriptions
- user_id: ID пользователя в Telegram (первичный ключ, внешний ключ к users)
- full_subscription: Тип полной подписки (количество месяцев)
- full_subscription_end: Дата окончания полной подписки
- basic_subscription: Тип базовой подписки (количество месяцев)
- basic_subscription_end: Дата окончания базовой подписки
- ad_free: Тип подписки на отключение рекламы (количество месяцев или 0 для постоянной)
- ad_free_end: Дата окончания подписки на отключение рекламы (NULL для постоянной)

## API эндпоинты

### GET /api/user/{user_id}
Получение информации о пользователе и его подписках

### POST /api/register
Регистрация пользователя с веб-сайта

### POST /api/subscription
Добавление подписки пользователю

### POST /api/topup
Пополнение баланса пользователя

## Интеграция с Telegram

### Авторизация
Используется Telegram Login Widget для авторизации пользователей на сайте.

### Веб-приложение в боте
Бот содержит встроенное веб-приложение для просмотра и покупки подписок.

### Синхронизация данных
Данные о пользователях и подписках синхронизируются между веб-сайтом и ботом через API.